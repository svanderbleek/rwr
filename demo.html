<html>
  <body>
    <h2>Term Rewriting</h2>
    <p>Syntax<p>
    <code id="exp">
      [[["f",["x", "x"]], [["f"],["g"]]],
       [["f",["x", "x"]], [["x"],["y"]]],
       [["f",["x", "x"]], [[f, ["x", "x"]],["x"]]]]
    </code>
    <button id="run">run</button>
    <textarea id="out"></textarea>
  </body>

  <style>
   #out { display: block; width: 100%; font: monospace; }
  </style>

  <script>
    const rewrite = (expression, rule) => {
      if(expression == rule[0]) return rule[1]
      try {
        [app, [args]] = expression
        return [rewrite(app, rule), [rewrite(args, rule)]]
      } catch {
        return expression.map((e) => rewrite(e, rule))
      }
    }

   const out = document.getElementById("out")
   const exp = document.getElementById("exp")
   const run = document.getElementById("run")

   run.addEventListener("click", () => out.innerHTML = JSON.stringify(eval(exp.innerHTML).map((e, r) => rewrite(e, r))))
  </script>
</html>
